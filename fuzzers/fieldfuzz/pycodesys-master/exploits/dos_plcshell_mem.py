#! /usr/bin/env python2
import sys
import time
sys.path.append("..")
from lib import pycodesys
import time

'''
Codesys Shell client implementation
'''

cds = pycodesys.CodesysNode(host=sys.argv[1], port=11740, verbose=True)
chan_id = cds.connect()
if not chan_id:
    exit(0)

cds.loginToDevice()

#cds.loginToApp()
#addr1 = 0xffffffff
addr1 = 0xb6281d0
addr2 = addr1

cnt = 0
while True:
    cnt +=1
    addr1 -= 10000024
    addr2 += 10000024
    cds.memdump(addr1)
    cds.memdump(addr2)
    print("counter: "+str(cnt))
# hostname = cds.host + ' plc'
#
# try:
#     while True:
#         print('--Codesys3 shell--')
#         incmd = str(raw_input(hostname + ' > '))
#         # cds.plcshell(incmd)
#         exit(1)
#
# except KeyboardInterrupt:
#     print('Interrupted')
#     cds.disconnect()
#     exit(0)
#

